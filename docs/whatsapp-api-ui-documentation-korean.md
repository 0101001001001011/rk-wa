# WhatsApp API 사용자 인터페이스 문서

이 문서는 WhatsApp API 멀티-인스턴스 서비스의 웹 사용자 인터페이스에 대한 포괄적인 정보를 제공합니다. 이 UI는 사용자가 직관적인 웹 인터페이스를 통해 여러 WhatsApp 인스턴스를 관리할 수 있게 하며, 메시징, 연락처 관리 및 시스템 모니터링 기능을 제공합니다.

## 목차

1. [소개](#소개)
2. [인증](#인증)
3. [대시보드](#대시보드)
4. [인스턴스 관리](#인스턴스-관리)
   - [인스턴스 생성](#인스턴스-생성)
   - [인스턴스 편집](#인스턴스-편집)
   - [인스턴스 세부 정보](#인스턴스-세부-정보)
   - [인스턴스 연결](#인스턴스-연결)
5. [메시징](#메시징)
   - [미니 채팅 인터페이스](#미니-채팅-인터페이스)
   - [메시지 보내기](#메시지-보내기)
   - [미디어 보내기](#미디어-보내기)
6. [연락처 관리](#연락처-관리)
   - [연락처 보기](#연락처-보기)
   - [연락처 추가](#연락처-추가)
   - [연락처 가져오기](#연락처-가져오기)
7. [통계](#통계)
8. [사용자 프로필](#사용자-프로필)
9. [기술 참조](#기술-참조)
   - [API 엔드포인트](#api-엔드포인트)
   - [웹훅](#웹훅)

## 소개

WhatsApp API 관리자는 단일 인터페이스에서 여러 WhatsApp 인스턴스를 관리할 수 있는 웹 기반 UI입니다. 이 시스템은 여러 WhatsApp 연결의 생성 및 관리, 메시지 송수신, 연락처 관리, 사용 통계 모니터링을 지원합니다.

주요 기능:
- 멀티-인스턴스 관리
- 실시간 메시징
- 연락처 관리
- 미디어 공유
- 알림을 위한 웹훅 통합
- 사용 통계

## 인증

시스템은 두 가지 인증 방법을 지원합니다:

1. **이메일과 비밀번호**: 등록된 이메일과 비밀번호를 사용한 전통적인 로그인
2. **API 키**: 개인 API 키를 사용한 인증

### 로그인 과정

1. `/login` 페이지로 이동합니다
2. 자격 증명(이메일/비밀번호 또는 API 키)을 입력합니다
3. 인증에 성공하면 인스턴스 페이지로 리디렉션됩니다

## 대시보드

메인 대시보드는 WhatsApp 인스턴스의 개요를 제공합니다. 로그인 후 `/ui/instances`로 이동하여 접근할 수 있습니다.

대시보드 표시 내용:
- 모든 인스턴스 목록
- 각 인스턴스의 현재 연결 상태
- 빠른 작업(세부 정보 보기, 편집, 채팅, 연락처, 삭제)
- 새 인스턴스 생성 옵션

## 인스턴스 관리

### 인스턴스 생성

새 WhatsApp 인스턴스를 생성하려면:

1. 대시보드에서 "새 인스턴스 생성" 버튼을 클릭합니다
2. 필수 세부 정보를 입력합니다:
   - **이름**: 인스턴스의 고유 식별자
   - **설명**: 선택적 설명
   - **웹훅 설정**: 알림 기본 설정 구성
     - 웹훅 URL
     - 알림 유형(수신/발신 메시지, 배달 상태, 읽음 상태)
     - 재시도 설정 및 보안 웹훅 통신을 위한 비밀 키
3. "인스턴스 생성"을 클릭하여 저장합니다

### 인스턴스 편집

기존 인스턴스를 편집하려면:

1. 대시보드에서 인스턴스 옆의 "편집" 버튼을 클릭합니다
2. 인스턴스 설정을 수정합니다
3. "변경 사항 저장"을 클릭하여 업데이트합니다

### 인스턴스 세부 정보

인스턴스 세부 정보 페이지는 특정 인스턴스에 대한 포괄적인 정보를 제공합니다:

- 연결 상태
- 인스턴스 정보(이름, 설명, 웹훅 URL)
- WhatsApp 연결용 QR 코드(해당하는 경우)
- 작업 버튼(재연결, 로그아웃)
- 채팅 및 연락처 인터페이스 링크
- 최근 활동 로그

### 인스턴스 연결

인스턴스를 WhatsApp에 연결하려면:

1. 인스턴스 세부 정보 페이지로 이동합니다
2. 연결되지 않은 경우 QR 코드가 표시됩니다
3. 모바일 WhatsApp 애플리케이션으로 QR 코드를 스캔합니다:
   - 휴대폰에서 WhatsApp을 엽니다
   - 설정 > WhatsApp 웹/데스크톱으로 이동합니다
   - 화면에 표시된 QR 코드를 스캔합니다
4. 연결되면 상태가 "연결됨"으로 변경됩니다

QR 코드가 보이지 않거나 만료된 경우:
1. "재연결" 버튼을 클릭합니다
2. 새 QR 코드가 나타날 때까지 기다립니다
3. 모바일 WhatsApp으로 새 코드를 스캔합니다

## 메시징

### 미니 채팅 인터페이스

채팅 인터페이스를 사용하면 실시간으로 메시지를 주고받을 수 있습니다:

1. 인스턴스에서 "채팅"을 클릭하여 채팅 페이지로 이동합니다
2. 대화를 시작하려면 왼쪽 패널에서 연락처를 선택합니다
3. 채팅 창에는 선택한 연락처와의 메시지 기록이 표시됩니다
4. 주기적인 폴링을 통해 새 메시지가 자동으로 나타납니다

### 메시지 보내기

텍스트 메시지를 보내려면:

1. 연락처 패널에서 연락처를 선택합니다
2. 하단의 입력 필드에 메시지를 입력합니다
3. Enter 키를 누르거나 "보내기"를 클릭합니다

### 미디어 보내기

미디어 파일을 보내려면:

1. 연락처 패널에서 연락처를 선택합니다
2. "파일 첨부" 버튼을 클릭합니다
3. 장치에서 파일을 선택합니다
4. 선택적으로 캡션을 추가합니다
5. "미디어 파일 보내기"를 클릭합니다

지원되는 미디어 유형:
- 이미지
- 비디오
- 문서
- 오디오 파일

## 연락처 관리

### 연락처 보기

연락처 페이지는 인스턴스와 연결된 모든 연락처를 표시합니다:

1. 인스턴스에서 "연락처"를 클릭하여 연락처 페이지로 이동합니다
2. 모든 연락처의 세부 정보가 있는 표를 확인합니다
3. 검색 상자를 사용하여 특정 연락처를 검색합니다

두 가지 연락처 소스 간에 전환할 수 있습니다:
- **WhatsApp**: WhatsApp 서버의 연락처
- **데이터베이스**: 로컬 데이터베이스에 저장된 연락처

### 연락처 추가

새 연락처를 추가하려면:

1. 연락처 페이지로 이동합니다
2. "새 연락처 추가" 섹션으로 스크롤합니다
3. 전화번호를 입력합니다(필수)
4. 이름을 입력합니다(선택 사항)
5. "연락처 추가"를 클릭합니다

### 연락처 가져오기

WhatsApp에서 로컬 데이터베이스로 연락처를 가져오려면:

1. 연락처 페이지로 이동합니다
2. "연락처 가져오기" 버튼을 클릭합니다
3. 가져오기 과정이 완료될 때까지 기다립니다
4. 가져온 연락처 수와 함께 성공 메시지가 나타납니다

## 통계

통계 페이지는 WhatsApp 인스턴스의 사용 지표를 제공합니다:

1. 탐색 표시줄에서 "통계"를 클릭하여 통계 페이지로 이동합니다
2. 시간 기간을 선택합니다(주, 월, 년 또는 모든 시간)
3. 집계된 통계를 확인합니다:
   - 총 메시지 보내기/받기
   - 미디어 파일 보내기/받기
   - API 호출
   - 웹훅 호출
4. 아래 표에서 개별 인스턴스 통계를 확인합니다

## 사용자 프로필

프로필 페이지는 계정 정보를 표시합니다:

1. 프로필 페이지로 이동합니다
2. 이메일 주소를 확인합니다
3. 프로그래밍 방식 접근을 위한 API 키를 확인하고 복사합니다
4. 이름 및 기타 계정 세부 정보를 확인합니다

## 기술 참조

### API 엔드포인트

UI는 다음과 같은 주요 API 엔드포인트와 상호 작용합니다:

- `/api/auth/login`: 인증
- `/api/auth/me`: 현재 사용자 정보
- `/api/instances`: 인스턴스 관리
- `/api/instances/:id`: 개별 인스턴스 작업
- `/api/instances/:id/qr`: QR 코드 생성
- `/api/instances/:id/send`: 메시지 보내기
- `/api/instances/:id/contacts`: 연락처 관리
- `/api/stats/user`: 사용 통계

### 웹훅

웹훅은 외부 시스템이 이벤트에 대한 알림을 받을 수 있게 합니다:

**구성 가능한 이벤트:**
- 메시지 수신
- 메시지 발신
- 배달 상태 변경
- 읽음 상태 변경

**웹훅 페이로드 형식:**
```json
{
  "event": "message_received",
  "data": {
    "instanceId": "인스턴스-아이디",
    "messageId": "메시지-아이디",
    "from": "발신자-아이디",
    "body": "메시지-내용",
    "timestamp": "iso-날짜-시간"
  },
  "timestamp": "iso-날짜-시간"
}
```

**보안 기능:**
- 페이로드 서명 검증을 위한 비밀 키
- 실패한 전송에 대한 구성 가능한 재시도 메커니즘
- 사용자 정의 HTTP 헤더 지원
